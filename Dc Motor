int trigPin = 9; // Trigger Ultrasonic
int echoPin = 8; // Echo Ultrasonic
int motorPin = 10; // DC Motor

int duration, distance; // to calculate distance

void setup() {
  // put your setup code here, to run once:

  // Set up the motor pin to be an output:

  pinMode(echoPin, INPUT);   // define the pin 8 as input (echoPin) 
  pinMode(trigPin,OUTPUT);   // define the pin 9 as output  (trigPin)
  pinMode(motorPin, OUTPUT); // define the pin 10 as output (motor)

  // Set up the serial port:

  Serial.begin(9600);

}

void loop() { // put your main code here, to run repeatedly:

  // The sensor is triggered by a HIGH pulse of 10 or more microseconds.
  // Give a short LOW pulse beforehand to ensure a clean HIGH pulse:
  
  digitalWrite(trigPin, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin, HIGH);
  delayMicroseconds(10);
  digitalWrite(trigPin, LOW);

  // Read the signal from the sensor: a HIGH pulse whose
  // duration is the time (in microseconds) from the sending
  // of the ping to the reception of its echo off of an object.
  
  duration = pulseIn(echoPin, HIGH);  // Read Echo time
  distance = (duration/2) / 29;  // Calculating distance using time

    Serial.print(distance);
    Serial.print("cm");
    Serial.println();
  
  delay (10);

    int Speed1 = 200;  // between 0 (stopped) and 255 (full speed)
    int Speed2 = 100;  // between 0 (stopped) and 150 (mid speed)
    int Speed3 = 0;    // between 0 (stopped) and 0 (Stop)

  if (distance >= 100) { // If the distance is bigger than 40 cm the vehicle velocity is full speed
      
    analogWrite(motorPin, Speed1);  // turns the motor On at Full Speed
    delay(10);                   // delay for onTime milliseconds
  }
  else if ( 99 >= distance && distance <= 51) { // In the range of 99 cm and 51 cm the vehicle velocity is mid speed
      
    analogWrite(motorPin, Speed2);  // turns the motor On at Mid Speed
    delay(10);                   // delay for onTime milliseconds
  }

  else if (distance <= 50) { // When is 50 or less cm the car will stop (This condition is the one I have problem)
      
    analogWrite(motorPin, Speed3);  // turns the motor Off Stop
    delay(10);                   // delay for onTime milliseconds
  }
  delay (1000);
}
